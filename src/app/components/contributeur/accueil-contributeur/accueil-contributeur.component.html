<!-- ===== PAGE CONTRIBUTEUR - LISTE & DEMANDE DE CONTRIBUTION ===== -->
<link href="https://cdn.jsdelivr.net/npm/remixicon@4.3.0/fonts/remixicon.css" rel="stylesheet"/>

<section class="contenair">
  <div class="grille">

    <!-- ===== COLONNE GAUCHE : OUTILS + LISTE PROJETS ===== -->
    <div class="col-gauche">
      <!-- Bandeau filtres / tri -->
      <div class="bloc outils">
        <div class="outils-groupe">
          <div class="champ rech">
            <i class="ri-search-line"></i>
            <input type="text" placeholder="Rechercher un projet (titre, domaine, gestionnaire)…" />
          </div>

          <div class="champ select">
            <i class="ri-filter-3-line"></i>
            <select aria-label="Filtrer par domaine">
              <option value="">Tous les domaines</option>
              <option>FINTECH</option>
              <option>HEALTHTECH</option>
              <option>EDTECH</option>
              <option>AGRITECH</option>
            </select>
          </div>

          <div class="champ select">
            <i class="ri-arrow-up-down-line"></i>
            <select aria-label="Trier">
              <option value="recents">Les plus récents</option>
              <option value="populaires">Les plus populaires</option>
              <option value="deadline">Échéance la plus proche</option>
            </select>
          </div>
        </div>

        <div class="outils-stats">
          <span><i class="ri-folder-2-line"></i> {{projets.length || 0}} projets</span>
          <span><i class="ri-thumb-up-line"></i> 860 soutiens</span>
          <span><i class="ri-time-line"></i> 42 en cours</span>
        </div>
      </div>

      <!-- Liste de cartes projets -->
      <div class="bloc cartes">
        <div class="liste-cartes" role="list">
          <!-- Carte projet 1 -->
        @for (proj of projets; track $index) {
          <article class="carte" role="listitem">
            <div class="carte-head">
              <h3 class="titre">{{proj?.titre}}</h3>
              <div class="tags">
                <span class="tag">{{proj.dommaine || "domaine"}}</span>
                <span class="tag soft">{{proj.niveauDAcces}}</span>
              </div>
            </div>

            <p class="desc">
              {{proj.description | slice:0.100}}{{ proj.description.length > 100 ? '...' : '' }}
            </p>

            <div class="meta">
              <span><i class="ri-user-3-line"></i> Gestionnaire : <b>{{proj.gestionnaire.prenom| slice:0.1}}{{ proj.description.length > 1 ? '.' : '' }} {{proj.gestionnaire.nom}}</b></span>
              <span><i class="ri-calendar-line"></i> Début : {{proj.dateDebut | date:'dd/MM/yyyy'}}</span>
              <span><i class="ri-heart-2-line"></i> Soutiens : {{proj.nombreSoutiens ||0}}</span>
            </div>

            <div class="actions" (click)="ouvert(proj)">
              <button class="btn-outline sm"><i class="ri-eye-line"></i> Détails</button>
              <button class="btn-primary sm" data-open="#modalDemande"><i class="ri-send-plane-line"></i> Demander à contribuer</button>
            </div>
          </article>
        }
        </div>
      </div>
    </div>


    <div class="col-droite">
      <div class="bloc slogan">
        <h2 class="slogan-titre">
          Contribue, apprends <br>et fais grandir <br>des projets concrets<span class="point">.</span>
        </h2>
      </div>


      <div class="bloc illustration">
        <img class="illu-img" src="contributeur.png" alt="Illustration contributeur">
      </div>

      <div class="bloc tips">
        <h4><i class="ri-lightbulb-line"></i> Astuce</h4>
        <p>Trie par <b>“Les plus récents”</b> pour repérer les nouvelles opportunités, ou filtre par <b>domaine</b> pour viser tes forces.</p>
      </div>
    </div>
  </div>
</section>

<div class="modal" [ngClass]="{'open': show}" id="modalDemande" >
  <div class="contenu" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <div class="modal-header">
      <h3 id="modalTitle">Demande de contribution</h3>
      <button class="btn-icon close" data-close aria-label="Fermer" (click)="fermer()"><i class="ri-close-line"></i></button>
    </div>

    <div class="modal-body">
      <div class="ligne">
        <label>Projet</label>
        <input type="text" [value]="projet.titre" disabled>
      </div>
      <div class="ligne">
        <label>Message au gestionnaire</label>
        <textarea rows="4" [(ngModel)]="message" placeholder="Présente ton profil, dispo, et ce que tu veux apporter…"></textarea>
      </div>
      <div class="ligne duo">
        <div>
          <label>Profil souhaité</label>
          <select [(ngModel)]="profileContributeur">
            <option value="DEV_FULLSTACK">Développeur FULLSTACK</option>
            <option value="DEV_MOBILE">Développeur Mobile</option>
            <option value="DEV_FRONT_END">Développeur Frontend</option>
            <option value="DESIGNER">Designer UI/UX</option>
            <option value="TESTER">QA / Test</option>
            <option value="DEV_OPS">DevOps</option>
          </select>
        </div>
      </div>
    </div>

    <div class="modal-actions">
      <button class="btn-secondary" data-close  (click)="fermer()">Annuler</button>
      <button class="btn-primary" style="background-color: #334DAA;color: #FFF;" (click)="valider(projet.id)">Envoyer la demande</button>
    </div>
  </div>
</div>
